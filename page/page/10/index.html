
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>Matt Aimonetti</title>
    <meta name="author" content="Matt Aimonetti">

    
    <meta name="description" content="MacRuby 0.5 Beta 1 and Textorize Good news everyone! MacRuby beta 1 has been released! Official announcement here. [caption id=&#8221;&#8221; align &hellip;">
    
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />

    <link href="/Matt-Aimonetti/atom.xml" rel="alternate" title="Matt Aimonetti" type="application/atom+xml">
    <link rel="canonical" href="http://mattetti.github.com/Matt-Aimonetti">
    <link href="/Matt-Aimonetti/favicon.png" rel="shortcut icon">
    <link href="/Matt-Aimonetti/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    
    
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30927742-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>


<body>
	<header><div id='meta' class='inner'>
  <div id="matt-aimonetti" itemscope itemtype="http://data-vocabulary.org/Person">
    <img class="photo left" src="/Matt-Aimonetti/images/matt_aimonetti.jpg" />
    <h1 class="left"><a itemprop="name" href="/Matt-Aimonetti/">Matt Aimonetti</a></h1>
    <br>
    <ul class='left'>
      <li><a href='http://www.linkedin.com/in/mattaimonetti'>Software Architecture</a> at <span itemprop="affiliation">LivingSocial</span></li>
      <li><a href='http://www.oreillynet.com/pub/au/4385'>Author</a> at <span itemprop="affiliation">O'Reilly</span></li>
      <li>Open-source <a href="/articles/archives">evangelist</a></li>
      <li><a href="https://github.com/mattetti">Web engineer</a></li>
    </ul>
  <nav class="menu left"><ul class="main">
	<li><a href="/Matt-Aimonetti/">Articles</a></li>
	<li><a href="/Matt-Aimonetti/posts/archives">Archives</a></li>
</ul>
</nav>
  <div class="right">
    <form class="search right" action="http://google.com/search" method="get">
      <input class="left" type="text" name="q" results="0">
      <input type="hidden" name="q" value="site:mattetti.github.com/Matt-Aimonetti">
    </form>
    <div class="social right">
      
      
      <a class="google" rel='me' href="https://plus.google.com/101114877505962271216?rel=author" title="Google+">Google+</a>
      
      
      <a class="twitter" rel='me' href="http://twitter.com/merbist" title="Twitter">Twitter</a>
      
      
      <a class="github" rel='me' href="https://github.com/mattetti" title="GitHub">GitHub</a>
      
      
      
      <a class="linkedin" rel='me' href="http://www.linkedin.com/in/mattaimonetti" title="Linkedin">Linkedin</a>
      
      
      <a class="rss" rel='me' href="/Matt-Aimonetti/atom.xml" title="RSS">RSS</a>
      
    </div>
  </div>
</div>

</header>
	
<!--
<div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/merbist">merbist</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading...</div>
</div>
<script src="/Matt-Aimonetti/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('merbist', 0, false);
	})(jQuery);
</script>
-->


	<div id="content" class="inner">


    <article class="post">
    <h1 class="title entry-title"><a href="/Matt-Aimonetti/posts/2009/10/07/macruby-0-5-beta-1-and-textorize/">MacRuby 0.5 Beta 1 and Textorize</a></h1>
    <div class="entry">
        <p>Good news everyone!</p>

<p>MacRuby beta 1 has been released! <a href="http://www.macruby.org/blog/2009/10/07/macruby05b1.html">Official announcement here</a>.</p>

<p>[caption id=&#8221;&#8221; align=&#8221;aligncenter&#8221; width=&#8221;144&#8221; caption=&#8221;Download MacRuby 0.5 beta1&#8221;]<a href="http://www.macruby.org/files/MacRuby%200.5%20beta%201.zip"><img src="http://www.macruby.org/images/zip.png" alt="Download MacRuby 0.5 beta1" /></a>[/caption]</p>

<p>Note that the download is only for SnowLeopard, intel machines.</p>

<p>Lots of great stuff in this new release, the first one based on LLVM. Check the <a href="http://www.macruby.org/blog/2009/10/07/macruby05b1.html">Laurent&#8217;s post</a> to learn more about the work done on compilation, optimization, concurrency, compatibility and Cocoa interaction. And a big thank you to <a href="http://www.youtube.com/watch?v=BVgM7qeAlko">Laurent Sansonetti</a> who is putting so much effort in this project!</p>

<p>However, don&#8217;t forget it&#8217;s still a beta release and you might encounter bugs. Feel free to report them in the bug tracker or ask on the mailing list.</p>

<p>On a different topic, the other day, John Gruber from <a href="http://daringfireball.net/">Daring Fireball</a> <a href="http://daringfireball.net/linked/2009/09/30/textorize">wrote a quick note</a> about <a href="http://mir.aculo.us/2009/09/29/textorize-pristine-font-rendering-for-the-web/">Thomas Fuchs&#8217; textorize script</a> which since got its own place on the internet <a href="http://textorize.org/">http://textorize.org/</a>.</p>

<p>Textorize is a Ruby-based font rasterizer command line utility for Mac OS X. It generates PNG files from an input string and options, using Mac OS X&#8217;s pristine typography facilities. As John said, it&#8217;s a case where a few lines of Ruby code beat Photoshop.</p>

<p>Thomas version is based on RubyCocoa which is great&#8230; but not MacRuby.</p>

<p>To celebrate<a href="http://www.macruby.org/blog/2009/10/07/macruby05b1.html"> MacRuby 0.5 beta1</a>, I ported the gem over and pushed it to the excellent <a href="http://gemcutter.org/">gemcutter.org facility</a>.</p>

<p>After installing MacRuby beta, follow these directives:</p>

<pre><code>$ macgem sources -a http://gemcutter.org
$ sudo macgem install textorize-mr
$ textorize -f"Didot" -s200 "MacRuby 0.5b1"
$ open output.png
</code></pre>

<p>And you will get a <a href="http://en.wikipedia.org/wiki/Subpixel_antialiasing">subpixel antialiased</a> fancy bitmap like that:</p>

<p><img src="http://merbist.com/wp-content/uploads/2009/10/macruby05b1.png" alt="macruby05b1" /></p>

<p>Check <a href="http://textorize.org/">http://textorize.org/</a> for more examples and <a href="http://github.com/mattetti/textorize">http://github.com/mattetti/textorize</a> for the source code.</p>

        
        
    </div>
    <div class="meta">
        <div class="date updated">








  


<time datetime="2009-10-07T20:45:02+02:00" pubdate data-updated="true">Oct 7<span>th</span>, 2009</time></div>
        <div class="tags">

<div class="cat">
  
    <a class='category' href='/Matt-Aimonetti/articles/categories/macruby/'>macruby</a>
  
</div>

</div>
        <div class='vcard author'><small>By <span class='fn'>Matt Aimonetti</span></small></div>
        
    </div>

</article>


    <article class="post">
    <h1 class="title entry-title"><a href="/Matt-Aimonetti/posts/2009/10/06/macruby-tips-how-to-play-an-audio-file/">MacRuby Tips: How to Play an Audio File</a></h1>
    <div class="entry">
        <p>Let&#8217;s say you would like to play an audio file in your MacRuby app/script, how would you do?
It&#8217;s actually pretty simple, you just need to use NSSound. If we wanted to use a system sound we could do:</p>

<pre><code>NSSound.soundNamed('Basso').play
</code></pre>

<p>But let&#8217;s look at a more advanced example with some Cocoa patterns. We will loop through all the audio files in a folder and we will play them one after the other.</p>

<pre><code>#!/usr/bin/env macruby
framework 'Cocoa'
# Cocoa documentation reference:
# http://developer.apple.com/mac/library/documentation/Cocoa/Reference/ApplicationKit/Classes/NSSound_Class/Reference/Reference.html

def play_sound
  if @sounds.empty?
    NSApplication.sharedApplication.terminate(nil)
  else
    sound_file = @sounds.shift
    s = NSSound.alloc.initWithContentsOfFile(sound_file, byReference: false)
    puts "previewing #{sound_file}"
    s.delegate = self
    s.play
  end
end

# This is a delegate method called by the sound object
def sound(sound, didFinishPlaying: state)
  play_sound if state
end

# Delegate method called when the app finished loading
def applicationDidFinishLaunching(notification)
  @sounds = Dir.glob("/System/Library/Sounds/*.aiff")
  play_sound
end

# We are delegating the application to self so the script will know when
# it finished loading
NSApplication.sharedApplication.delegate = self
NSApplication.sharedApplication.run
</code></pre>

<p>On my machine, I get the following output:</p>

<pre><code>$ macruby macrubysound.rb
previewing /System/Library/Sounds/Basso.aiff
previewing /System/Library/Sounds/Blow.aiff
previewing /System/Library/Sounds/Bottle.aiff
previewing /System/Library/Sounds/Frog.aiff
previewing /System/Library/Sounds/Funk.aiff
previewing /System/Library/Sounds/Glass.aiff
previewing /System/Library/Sounds/Hero.aiff
previewing /System/Library/Sounds/Morse.aiff
previewing /System/Library/Sounds/Ping.aiff
previewing /System/Library/Sounds/Pop.aiff
previewing /System/Library/Sounds/Purr.aiff
previewing /System/Library/Sounds/Sosumi.aiff
previewing /System/Library/Sounds/Submarine.aiff
previewing /System/Library/Sounds/Tink.aiff
</code></pre>

<p>Cocoa delegation might seem a bit strange at first when you come from Ruby. In Ruby we rarely do any type of async delegation so let&#8217;s quickly look at what&#8217;s going on in this script.</p>

<p>The first thing we do is loading the cocoa framework which makes total sense, then we define a bunch of methods and finally we get to:</p>

<pre><code>NSApplication.sharedApplication.delegate = self
NSApplication.sharedApplication.run
</code></pre>

<p>We are setting the run loop to delegate to set, which means that when an event is triggered, the delegation method will be called on self (our script).
Once that done, we are starting out run loop.</p>

<p>Once the application is loaded the applicationDidFinishLaunching delegate is being triggered (line 24). At this point, we are looking for all the sound files in the sound system folder and storing them in an instance variable (line 25). Finally, we are calling the play_sound method (line 26).</p>

<p>The play_sound method checks that we have some audio files left to play (line 7), otherwise it quits the app. (line 8 ) If we still have some files in the queue, we get the first one (line 10) and use it to create an instance of NSSound (line 11).</p>

<p>Before playing the NSSound instance, we are setting its delegate to our script (self) (line 13). If you read <a href="http://developer.apple.com/mac/library/documentation/Cocoa/Reference/ApplicationKit/Classes/NSSound_Class/Reference/Reference.html">NSSound Cocoa documentation</a> for #play, you will notice that #play &#8220;initiates playback asynchronously and returns control to your application. Therefore, your application can continue doing work while the audio is playing.&#8221; In our case, we don&#8217;t want to do that, otherwise all the sounds will play at the same time.</p>

<p>The documentation also mentions a delegation you can use to avoid that. This is exactly what we did when we implemented:  def sound(sound, didFinishPlaying: state) (line 19)</p>

<p>Rubyists might be surprised by the method signature. MacRuby extended Ruby to support Objective-C selectors.</p>

<p>When the sound is playing, this delegate gets called, we check on the state of the sound, if it finished playing then we call play_sound again.</p>

<p>That&#8217;s it!  It&#8217;s a very elegant implementation giving us the benefits of both Ruby and Cocoa.</p>

        
        
    </div>
    <div class="meta">
        <div class="date updated">








  


<time datetime="2009-10-06T19:00:08+02:00" pubdate data-updated="true">Oct 6<span>th</span>, 2009</time></div>
        <div class="tags">

<div class="cat">
  
    <a class='category' href='/Matt-Aimonetti/articles/categories/macruby/'>macruby</a>
  
</div>

</div>
        <div class='vcard author'><small>By <span class='fn'>Matt Aimonetti</span></small></div>
        
    </div>

</article>


    <article class="post">
    <h1 class="title entry-title"><a href="/Matt-Aimonetti/posts/2009/10/06/macruby-tips-embed-a-custom-font/">MacRuby Tips: Embed a Custom Font</a></h1>
    <div class="entry">
        <p>Let say you want to release your MacRuby app and use a custom embedded font?
You probably don&#8217;t want to force your users to install the font.
Well, don&#8217;t worry, just put the font file in your resources folder and use the following code:</p>

<pre><code>font_location = NSBundle.mainBundle.pathForResource('MyCustomFont', ofType: 'ttf')
font_url = NSURL.fileURLWithPath(font_location)
# in MacRuby, always make sure that cocoa constants start by an uppercase
CTFontManagerRegisterFontsForURL(font_url, KCTFontManagerScopeProcess, nil)
</code></pre>

<p>That&#8217;s it, now your custom font is available and you can change your textfield instance&#8217;s font like that:</p>

<pre><code>text_field.font = NSFont.fontWithName('MyCustomFont', size:24)
</code></pre>

<p>The only tricky things here were to know the Cocoa API call and to know that even if the Cocoa API references the constant to use as kCTFontManagerScopeProcess, because in Ruby, constants start by an uppercase, you need to convert it to: KCTFontManagerScopeProcess.</p>

        
        
    </div>
    <div class="meta">
        <div class="date updated">








  


<time datetime="2009-10-06T09:23:44+02:00" pubdate data-updated="true">Oct 6<span>th</span>, 2009</time></div>
        <div class="tags">

<div class="cat">
  
    <a class='category' href='/Matt-Aimonetti/articles/categories/macruby/'>macruby</a>
  
</div>

</div>
        <div class='vcard author'><small>By <span class='fn'>Matt Aimonetti</span></small></div>
        
    </div>

</article>


    <article class="post">
    <h1 class="title entry-title"><a href="/Matt-Aimonetti/posts/2009/10/05/macruby-soon-to-reach-a-new-milestone/">MacRuby Soon to Reach a New Milestone</a></h1>
    <div class="entry">
        <p>Laurent just posted a <a href="http://bit.ly/2YPwRT">MacRuby status update</a> on the mailing list and the first official beta of MacRuby 0.5 should be released pretty soon.</p>

<p>Let&#8217;s quickly look at Laurent&#8217;s report:</p>

<ul>
<li><p>Early backtracing support.</p></li>
<li><p>Much better AOT compilation. Parts of the standard library are now pre-compiled for testing.</p></li>
<li><p>Migrated to LLVM top of tree.</p></li>
<li><p>Dispatcher performance is now back to normal (we lost about 30% due to gcc not inlining code).</p></li>
<li><p>Many bug fixes.</p></li>
</ul>


<p>In lay terms, backtracing is what you see when your app crashes or has a problem, it&#8217;s the list of methods called before the exception was raised and the line where the error happened. Currently the backtrace is similar to what you would have with Ruby 1.9, however objective-c exceptions are not supported and there is still some work to do.</p>

<p>AOT compilation or Ahead Of Time compilation is the process of compiling a script into machine code. I already covered that <a href="http://merbist.com/2009/07/12/compiled-hello-world-with-macruby/">feature earlier</a>. Progress has been made and now some Ruby standard libraries are now pre-compiled in MacRuby. The two main advantages of doing AOT compilation are startup speed and obfuscation. Two important features for desktop applications or for when you want to license your server app.</p>

<p>Updating LLVM doesn&#8217;t mean much for end users. With the support of the MacRuby team, <a href="http://www.icoretech.org/">Claudio</a> setup a nightly build bot <a href="http://macruby.icoretech.org/">http://macruby.icoretech.org/</a> allowing you to download nightly builds for SnowLeopard. The app is a <a href="http://sinatrarb.com">Sinatra app</a> that could can checkout on github:  <a href="http://github.com/masterkain/macruby-nightlies-web">http://github.com/masterkain/macruby-nightlies-web</a> What&#8217;s interesting is that Apple is sponsoring both LLVM and MacRuby which will hopefully bring some synergy and help both projects.</p>

<p>Fixed dispatcher, this is a just a perf bug fix only affecting people on trunk.</p>

<p>I personally used MacRuby quite a lot recently. I have been writing a 2D video game for my <a href="http://rubyconf.org/talks/153-writing-2-d-games-for-the-osx-platform-in-ruby">RubyConf talk</a>.</p>

<p><img src="http://img.skitch.com/20091006-kj64ix4up5q8dh4yin38hjrjcp.jpg" alt="" />It&#8217;s a simple game only using Ruby and Cocoa. It&#8217;s not a fancy game and, no, it doesn&#8217;t run on the iPhone yet ;)</p>

<p>I never wrote a game in Cocoa and I decided not to use an existing framework like Gosu or cocos2d, instead I decided to write everything from scratch. Using CoreAnimation instead of OpenGL, the task wasn&#8217;t that hard at all. in less than 1,000 LOC (before refactoring), I have a fully working game.</p>

<p>I will be previewing the game at <a href="http://www.railssummit.com.br/">RailsSummit</a> and will show the code and explain how to get there at <a href="http://rubyconf.org/talks/153-writing-2-d-games-for-the-osx-platform-in-ruby">RubyConf</a>.</p>

<p>When I started getting involved with MacRuby, I really did not think I would write a video game in Ruby and actually enjoy it. At the end of the day, I will more than likely use MacRuby for desktop/mobile/server apps more than games, but it&#8217;s awesome to be able to use your favorite language to do other things than what you are usually paid to do.</p>

<p>MacRuby is coming along very nicely, and I&#8217;m really excited about the multitude of new options offered to Ruby developers on OSX and can&#8217;t wait for 0.5 final and see what people will do with it.</p>

        
        
    </div>
    <div class="meta">
        <div class="date updated">








  


<time datetime="2009-10-05T23:58:53+02:00" pubdate data-updated="true">Oct 5<span>th</span>, 2009</time></div>
        <div class="tags">

<div class="cat">
  
    <a class='category' href='/Matt-Aimonetti/articles/categories/macruby/'>macruby</a>
  
</div>

</div>
        <div class='vcard author'><small>By <span class='fn'>Matt Aimonetti</span></small></div>
        
    </div>

</article>


    <article class="post">
    <h1 class="title entry-title"><a href="/Matt-Aimonetti/posts/2009/08/30/blog-status/">Blog Status</a></h1>
    <div class="entry">
        <p>I had people asking me how come I was not blogging as much lately. Well, on top of being really busy, I have been blogging on other blogs such as the <a href="http://weblog.rubyonrails.org/">official Rails blog</a>.</p>

<p>There aren&#8217;t a lot of Merb news, we are waiting for Carl and Yehuda to sign out on the 1.1 release and will hopefully soon start the migration work to Rails3. If you want more news about Rails3, check <a href="http://yehudakatz.com/">Yehuda&#8217;s blog</a> and the <a href="http://weblog.rubyonrails.com/">official Rails blog</a>. Lots of exciting things are coming up.</p>

<p>Finally, if you are planning on upgrading your Mac to Snow Leopard, <a href="http://weblog.rubyonrails.org/2009/8/30/upgrading-to-snow-leopard">these instructions</a> are also valid for all Ruby developers on an Intel mac.</p>

        
        
    </div>
    <div class="meta">
        <div class="date updated">








  


<time datetime="2009-08-30T16:35:01+02:00" pubdate data-updated="true">Aug 30<span>th</span>, 2009</time></div>
        <div class="tags">

<div class="cat">
  
    <a class='category' href='/Matt-Aimonetti/articles/categories/misc/'>Misc</a>
  
</div>

</div>
        <div class='vcard author'><small>By <span class='fn'>Matt Aimonetti</span></small></div>
        
    </div>

</article>

<nav id="pagenavi">
    
        <a href="/Matt-Aimonetti/page/page/9/" class="prev">Prev</a>
    
    
        <a href="/Matt-Aimonetti/page/page/11/" class="next">Next</a>
    
    <a href="/Matt-Aimonetti/articles/archives" class="center">Archives</a>
</nav>
</div>
	<footer class="inner"><div id='copyright-notice'>Copyright &copy; 2012 Matt Aimonetti</div>
</footer>
	<script src="/Matt-Aimonetti/javascripts/jquery.fancybox.pack.js"></script>
<script src="/Matt-Aimonetti/javascripts/slash.js"></script>




</body>
</html>
